```uml
@startuml
alt 購入完了まで

ユーザー -> webサーバー : 購入ボタンクリック
webサーバー -> ユーザー : お届け先確認画面表示

opt お届け先情報変更
ユーザー -> webサーバー : 変更ボタンクリック
webサーバー -> ユーザー : お届け先変更ページ表示
ユーザー -> webサーバー : お届け先情報入力後変更ボタン入力
webサーバー -> DBサーバー: お届け先情報変更処理
DBサーバー --> DBサーバー : お届け先情報変更処理
DBサーバー --> webサーバー: 結果表示
webサーバー -> ユーザー : 結果表示(お届け先情報確認画面)
end

ユーザー -> webサーバー : お支払い情報入力後　購入処理
webサーバー -> DBサーバー: 購入処理
DBサーバー --> DBサーバー : 購入処理,在庫数を減らす処理,購入履歴追加処理
DBサーバー --> webサーバー: 結果表示
webサーバー -> ユーザー : 結果表示
opt 在庫が規定量より少なくなった
DBサーバー -> メールサーバー : 在庫補充処理
alt 手動発注
メールサーバー -> 発注責任者 : 発注確認メール送信
発注責任者 -> 取引先相手 : 発注メール送信
else 自動発注
メールサーバー -> 取引先相手 : 発注メール送信
メールサーバー -> 発注責任者 : 発注完了メール送信
end
end
end
@enduml
```
